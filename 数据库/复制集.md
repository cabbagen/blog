
#### 一、复制集成员
在 mongodb 中，一个复制集就是一组 mongod 的进程。它们提供了数据冗余和高可用性。一般包括以下三种：primary、 secondaries、 arbiter。


##### primary

在 mongodb 的复制集中，primary 是唯一个可以执行 写操作 的成员。
在执行操作的时候，他会将操作记录在 oplog 文件。
secondary 成员调用这些记录，在自己的副本集数据中执行相应的操作，保持与 primary 数据的一致性。

默认状态下，客户端默认会从 primary 上读取数据，如果需要从 secondary 成员中读取数据，可以进行额外的配置。

当 primary 成员不可用时，secondary 成员间会进行选举，选择出另一个 primary 成员。在这期间数据库只能执行 读操作， 而不能执行 写操作。


##### secondary

**作为备用的优先级为 0 的 secondary 成员（ Priority 0 Replica Set Members）**     

优先级为 0 的成员不能成为 primary ，并且也不能触发选举。除了这些的限制，它包含了数据集合的副本，能够执行 读操作，并且能够在选举中进行投票。

在大多数情况下，并不需要将 secndary 成员的 优先级 设置为 0。然而，由于硬件条件的限制，当我们需要只令某些 secndary 成员可称为 primary 成员时，这将是特别有用的。

将辅助节点配置为具有优先级 0 时，请考虑潜在的故障切换模式，包括所有可能的网络分区。
始终确保你的主数据中心既包含法定人数的投票成员，又包含有资格成为主要成员的成员。


**隐藏的 secondary 成员（Hidden Replica Set Members）**

一个隐藏的成员包含了 primary 数据的副本，但是对于客户端程序来说却是不可见的。
隐藏的成员适用于具有与副本集中其他成员不同使用模式的工作负载。
隐藏的成员必须优先级设置为 0，因此也不能成为主键，但是可以在选举中投票。

下面是有五个成员的副本集，4 个具有 primary 数据的副本，但是其中有一个是隐藏的。

![image](https://docs.mongodb.com/manual/_images/replica-set-hidden-member.bakedsvg.svg)


客户端并不会带有读偏好的读操作分发给隐藏的成员。因此，处理基本的复制操作，他们并不会接收其他的流量。使用隐藏成员主要是为了专业的任务，像是报告和备份。

隐藏的成员可以在选举中进行投票，如果需要停止一个隐藏成员的投票，需要确保这个副本集中要还存活着大多数成员或 primary 将要下线。


**延迟的 secondary 成员 （Delayed Replica Set Members）**    

延迟成员包含了数据集的数据集的副本。然而，一个延迟成员设置了一个数据集状态更早时间的反映（reflects）。
例如当前时间是 09:52, 并且一个成员有一个一小时的延迟，延迟的成员没有比 08:52 更近时间的操作。

由于 延迟成员 是一个数据集合的历史快照，他可能帮助你恢复历史数据。
例如，延迟成员可以从不成功的应用程序升级和操作员错误（包括丢弃的数据库和集合）中恢复。

延迟成员注意事项：

* 必须是一个优先级为 0 的成员

* 必须是一个隐藏的成员

* 如果 members[n].votes 设置为 1， 便能够在选举中进行投票 