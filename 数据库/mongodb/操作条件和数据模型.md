
在 mongodb 中为应用程序建立数据模型应该考虑到数据的特点 以及 mongodb 本身的性能。 例如：不同的数据模型能够允许更有效率的查询、增加插入和更新操作的吞吐量，或者更有效地将活动分配到分片集群。

有些因素是在应用程序之外出现的操作或地址要求，但会影响基于MongoDB的应用程序的性能。在开发数据模型时，可以结合以下注意事项分析所有应用程序的读写操作。


##### 一、Document Growth （文档增长）

对于文档的更新操作可能会增加文档的大小。这些更新包括向数组中添加一个元素或者在文档中添加一个字段。   

当使用 MMAPv1 存储引擎时，文档增长可以作为数据模型的考虑因素。对于 MMAPv1 来说，如果文档大小超过了允许的空间，mongodb 将会重定位磁盘上的文档。但是，对于MongoDB 3.0.0，默认使用 [Power of 2 Sized Allocations](https://docs.mongodb.com/v3.6/core/mmapv1/#power-of-2-allocation) 可以最大限度地减少此类重新分配的发生，并允许有效重用已释放的记录空间。

当使用 MMAPv1 存储引擎时，如果你的应用程序需要频繁地进行文档增长地更新，这将导致文档增长超过 2 分配的当前功率。你可能需要参考当前的数据模型，改用
规范的数据模型，用引用来关联不同文档中的数据。

你也可以使用一个预分配策略明确的避免文档增长。参考 [Pre-Aggregated Reports Use Case](https://docs.mongodb.com/ecosystem/use-cases/pre-aggregated-reports-mmapv1/)


##### 二、Atomicity （原子性）

